<section
    id="homemade-indulgence"
    class="p-4 scroll-mt-10 bg-primary text-neutral"
  >
    <h1>Our Products</h1>

    <div
      class="flex flex-col lg:flex-row lg:justify-between gap-y-4 lg:gap-y-0 mx-6"
    >
      <div class="flex flex-col gap-y-2">
        <div class="text-xs sm:text-sm uppercase">Indulgence Category</div>

        <div class="flex flex-wrap gap-2 text-xs sm:text-base">
          <button
            *ngFor="let category of bakeryProductCategories"
            (click)="selectedBakeryProductCategory = category"
            class="border border-neutral px-2 py-1 rounded-md"
            [ngClass]="
              selectedBakeryProductCategory === category
                ? 'bg-neutral text-primary'
                : 'text-neutral'
            "
          >
            {{ category }}
          </button>
        </div>
      </div>

      <div class="flex flex-col gap-y-2">
        <div class="text-xs sm:text-sm uppercase">Dietary Option</div>

        <div class="flex flex-wrap gap-2 text-xs sm:text-base">
          <button
            *ngFor="let dietaryOption of dietaryOptions"
            (click)="updateSelectedDietaryOptions(dietaryOption)"
            class="border border-neutral px-2 py-1 rounded-md"
            [ngClass]="{
              'bg-neutral text-primary': dietaryOption === 'All' && isDietaryOptionSelected('All'),
              'bg-food-vegan': dietaryOption === DietaryOption.VEGAN && isDietaryOptionSelected(DietaryOption.VEGAN),
              'bg-food-vegetarian': dietaryOption === DietaryOption.VEGETARIAN && isDietaryOptionSelected(DietaryOption.VEGETARIAN),
              'bg-food-egg': dietaryOption === DietaryOption.EGG && isDietaryOptionSelected(DietaryOption.EGG),
              'bg-food-nonVegetarian': dietaryOption === DietaryOption.NON_VEGETARIAN && isDietaryOptionSelected(DietaryOption.NON_VEGETARIAN),
            }"
          >
            {{ dietaryOption | enumParser }}
          </button>
        </div>
      </div>
    </div>

    <ng-container
      *ngIf="
        bakeryProducts
          | productFilter : 'category' : selectedBakeryProductCategory
          | dietaryFilter : selectedDietaryOptions : 'Bakery';
        let filteredProducts = $implicit
      "
    >
      <ng-container
        *ngIf="filteredProducts.length; else NoProductsAvailable"
      >
        <div
          class="m-6 flex overflow-x-scroll sm:overflow-x-auto sm:grid sm:grid-cols-3 md:grid-cols-4 xl:grid-cols-5 gap-6"
        >
          <div
            *ngFor="let product of filteredProducts"
            class="w-1/2 shrink-0 sm:w-auto sm:col-span-1 flex flex-col bg-neutral p-3 mb-2 sm:mb-0"
          >
            <img
              src="/assets/media/bakery-products/{{ product.imageFileName }}"
              alt="A photo of the product: {{ product.name }}."
              class="border border-secondary"
            />
            <div class="flex flex-col h-full text-primary">
              <div class="text-base sm:text-lg font-semibold">
                {{ product.name }}
              </div>
              <div class="flex justify-between items-center">
                <div
                  *ngIf="selectedBakeryProductCategory === 'All'"
                  class="text-xs uppercase"
                >
                  {{ product.category }}
                </div>
                <div class="flex items-center gap-x-2">
                  <div
                    *ngFor="let dietaryOption of product.dietaryOptions"
                    [title]="dietaryOption | enumParser"
                    class="cursor-pointer w-3 h-3"
                  >
                    <svg class="fill-none w-full h-full">
                      <use
                        [attr.xlink:href]="
                          'assets/sprite-sheet.svg#' + dietaryOption
                        "
                        class="fill-none stroke-none"
                      ></use>
                    </svg>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </ng-container>
</section>

<ng-template #NoProductsAvailable>
    <div class="text-neutral w-full m-6 text-center">
      Sorry, no products are available under the current filter criteria!
    </div>
</ng-template>